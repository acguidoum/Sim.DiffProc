<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="A.C. Guidoum and K. Boukhetala" />

<meta name="date" content="2020-11-07" />

<title>Monte-Carlo Simulation and Kernel Density Estimation of First passage time</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 800px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 20px;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 0;
padding: 4px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table:not([class]) {
margin: auto;
min-width: 40%;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table[summary="R argblock"] {
width: 100%;
border: none;
}
table:not([class]) th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table:not([class]) td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table:not([class]), table:not([class]) th, table:not([class]) td {
border-left-style: none;
border-right-style: none;
}
table:not([class]) tr.odd {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 13px;
padding-bottom: 1px;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f5f5f5;
border-radius: 3px;
color: #333;
}
pre {
overflow-x: auto;
border-radius: 3px;
margin: 5px 0 10px 0;
padding: 10px;
}
pre:not([class]) {
background-color: white;
border: #f5f5f5 1px solid;
}
pre:not([class]) code {
color: #444;
background-color: white;
}
code {
font-family: monospace;
font-size: 90%;
}
p > code, li > code {
padding: 2px 4px;
color: #d14;
border: 1px solid #e1e1e8;
white-space: inherit;
}
div.figure {
text-align: center;
}
table > caption, div.figure p.caption {
font-style: italic;
}
table > caption span, div.figure p.caption span {
font-style: normal;
font-weight: bold;
}
p {
margin: 0 0 10px;
}
table:not([class]) {
margin: auto auto 10px auto;
}
img:not([class]) {
background-color: #FFFFFF;
padding: 2px;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
max-width: 100%;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f5f5f5;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f5f5f5;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f5f5f5;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }
div.r-help-page {
background-color: #f9f9f9;
border-bottom: #ddd 1px solid;
margin-bottom: 10px;
padding: 10px;
}
div.r-help-page:hover {
background-color: #f4f4f4;
}

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Monte-Carlo Simulation and Kernel Density Estimation of First passage time</h1>
<h4 class="author">A.C. Guidoum<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and K. Boukhetala<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></h4>
<h4 class="date">2020-11-07</h4>


<div id="TOC">
<ul>
<li><a href="#the-fptsdekd-functions">The <code>fptsdekd()</code> functions</a></li>
<li><a href="#examples">Examples</a>
<ul>
<li><a href="#fpt-for-1-dim-sde">FPT for 1-Dim SDE</a>
<ul>
<li><a href="#fptsde1d-vs-approx.fpt.density"><code>fptsde1d()</code> vs <code>Approx.fpt.density()</code></a></li>
<li><a href="#fptsde1d-vs-gqd.tipassage"><code>fptsde1d()</code> vs <code>GQD.TIpassage()</code></a></li>
</ul></li>
<li><a href="#fpt-for-2-dim-sdes">FPT for 2-Dim SDE’s</a></li>
<li><a href="#fpt-for-3-dim-sdes">FPT for 3-Dim SDE’s</a></li>
</ul></li>
<li><a href="#further-reading">Further reading</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="the-fptsdekd-functions" class="section level1">
<h1>The <code>fptsdekd()</code> functions</h1>
<p>A new algorithm based on the Monte Carlo technique to generate the random variable FPT of a time homogeneous diffusion process (1, 2 and 3D) through a time-dependent boundary, order to estimate her probability density function.</p>
<p>Let <span class="math inline">\(X_t\)</span> be a diffusion process which is the unique solution of the following stochastic differential equation:</p>
<p><span class="math display">\[\begin{equation}\label{eds01}
  dX_t = \mu(t,X_t) dt + \sigma(t,X_t) dW_t,\quad X_{t_{0}}=x_{0}
\end{equation}\]</span></p>
<p>if <span class="math inline">\(S(t)\)</span> is a time-dependent boundary, we are interested in generating the first passage time (FPT) of the diffusion process through this boundary that is we will study the following random variable:</p>
<p><span class="math display">\[
\tau_{S(t)}=
\left\{
  \begin{array}{ll}
    inf \left\{t: X_{t} \geq S(t)|X_{t_{0}}=x_{0} \right\} &amp; \hbox{if} \quad x_{0} \leq S(t_{0}) \\
    inf \left\{t: X_{t} \leq S(t)|X_{t_{0}}=x_{0} \right\} &amp; \hbox{if} \quad x_{0} \geq S(t_{0})
  \end{array}
\right.
\]</span></p>
<p>The main arguments to ‘random’ <code>fptsdekd()</code> (where <code>k=1,2,3</code>) consist:</p>
<ul>
<li><code>object</code> an object inheriting from class <code>snssde1d</code>, <code>snssde2d</code> and <code>snssde3d</code>.</li>
<li><code>boundary</code> an expression of a constant or time-dependent boundary <span class="math inline">\(S(t)\)</span>.</li>
</ul>
<p>The following statistical measures (<code>S3 method</code>) for class <code>fptsdekd()</code> can be approximated for F.P.T <span class="math inline">\(\tau_{S(t)}\)</span>:</p>
<ul>
<li>The expected value <span class="math inline">\(\text{E}(\tau_{S(t)})\)</span>, using the command <code>mean</code>.</li>
<li>The variance <span class="math inline">\(\text{Var}(\tau_{S(t)})\)</span>, using the command <code>moment</code> with <code>order=2</code> and <code>center=TRUE</code>.</li>
<li>The median <span class="math inline">\(\text{Med}(\tau_{S(t)})\)</span>, using the command <code>Median</code>.</li>
<li>The mode <span class="math inline">\(\text{Mod}(\tau_{S(t)})\)</span>, using the command <code>Mode</code>.</li>
<li>The quartile of <span class="math inline">\(\tau_{S(t)}\)</span>, using the command <code>quantile</code>.</li>
<li>The maximum and minimum of <span class="math inline">\(\tau_{S(t)}\)</span>, using the command <code>min</code> and <code>max</code>.</li>
<li>The skewness and the kurtosis of <span class="math inline">\(\tau_{S(t)}\)</span>, using the command <code>skewness</code> and <code>kurtosis</code>.</li>
<li>The coefficient of variation (relative variability) of <span class="math inline">\(\tau_{S(t)}\)</span>, using the command <code>cv</code>.</li>
<li>The central moments up to order <span class="math inline">\(p\)</span> of <span class="math inline">\(\tau_{S(t)}\)</span>, using the command <code>moment</code>.</li>
<li>The result summaries of the results of Monte-Carlo simulation, using the command <code>summary</code>.</li>
</ul>
<p>The main arguments to ‘density’ <code>dfptsdekd()</code> (where <code>k=1,2,3</code>) consist:</p>
<ul>
<li><code>object</code> an object inheriting from class <code>fptsdekd()</code> (where <code>k=1,2,3</code>).</li>
<li><code>pdf</code> probability density function <code>Joint</code> or <code>Marginal</code>.</li>
</ul>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<div id="fpt-for-1-dim-sde" class="section level2">
<h2>FPT for 1-Dim SDE</h2>
<p>Consider the following SDE and linear boundary:</p>
<p><span class="math display">\[\begin{align*}
  dX_{t}= &amp; (1-0.5 X_{t}) dt + dW_{t},~x_{0} =1.7.\\
  S(t)= &amp; 2(1-sinh(0.5t))
\end{align*}\]</span></p>
<p>Generating the first passage time (FPT) of this model through this boundary: <span class="math display">\[
\tau_{S(t)}=
    \inf \left\{t: X_{t} \geq S(t) |X_{t_{0}}=x_{0} \right\} ~~ \text{if} \quad x_{0} \leq S(t_{0})
\]</span></p>
<p>Set the model <span class="math inline">\(X_t\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>, <span class="dt">kind =</span> <span class="st">&quot;L&#39;Ecuyer-CMRG&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>R<span class="op">&gt;</span><span class="st"> </span>f &lt;-<span class="st"> </span><span class="kw">expression</span>( (<span class="dv">1</span><span class="fl">-0.5</span><span class="op">*</span>x) )</span>
<span id="cb1-3"><a href="#cb1-3"></a>R<span class="op">&gt;</span><span class="st"> </span>g &lt;-<span class="st"> </span><span class="kw">expression</span>( <span class="dv">1</span> )</span>
<span id="cb1-4"><a href="#cb1-4"></a>R<span class="op">&gt;</span><span class="st"> </span>mod1d &lt;-<span class="st"> </span><span class="kw">snssde1d</span>(<span class="dt">drift=</span>f,<span class="dt">diffusion=</span>g,<span class="dt">x0=</span><span class="fl">1.7</span>,<span class="dt">M=</span><span class="dv">1000</span>,<span class="dt">method=</span><span class="st">&quot;taylor&quot;</span>)</span></code></pre></div>
<p>Generate the first-passage-time <span class="math inline">\(\tau_{S(t)}\)</span>, with <code>fptsde1d()</code> function ( based on <code>density()</code> function in [base] package):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>R<span class="op">&gt;</span><span class="st"> </span>St  &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">sinh</span>(<span class="fl">0.5</span><span class="op">*</span>t)) )</span>
<span id="cb2-2"><a href="#cb2-2"></a>R<span class="op">&gt;</span><span class="st"> </span>fpt1d &lt;-<span class="st"> </span><span class="kw">fptsde1d</span>(mod1d, <span class="dt">boundary =</span> St)</span>
<span id="cb2-3"><a href="#cb2-3"></a>R<span class="op">&gt;</span><span class="st"> </span>fpt1d</span></code></pre></div>
<pre><code>Itô Sde 1D:
    | dX(t) = (1 - 0.5 * X(t)) * dt + 1 * dW(t)
    | t in [0,1].
Boundary:
    | S(t) = 2 * (1 - sinh(0.5 * t))
F.P.T:
    | T(S(t),X(t)) = inf{t &gt;=  0 : X(t) &gt;=  2 * (1 - sinh(0.5 * t)) }
    | Crossing realized 966 among 1000.</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(fpt1d<span class="op">$</span>fpt, <span class="dt">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>[1] 0.038850 0.042709 0.113998 0.066493 0.244749</code></pre>
<p>The following statistical measures (<code>S3 method</code>) for class <code>fptsde1d()</code> can be approximated for the first-passage-time <span class="math inline">\(\tau_{S(t)}\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(fpt1d)</span>
<span id="cb6-2"><a href="#cb6-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt1d , <span class="dt">center =</span> <span class="ot">TRUE</span> , <span class="dt">order =</span> <span class="dv">2</span>) <span class="co">## variance</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">Median</span>(fpt1d)</span>
<span id="cb6-4"><a href="#cb6-4"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">Mode</span>(fpt1d)</span>
<span id="cb6-5"><a href="#cb6-5"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(fpt1d)</span>
<span id="cb6-6"><a href="#cb6-6"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">kurtosis</span>(fpt1d)</span>
<span id="cb6-7"><a href="#cb6-7"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">skewness</span>(fpt1d)</span>
<span id="cb6-8"><a href="#cb6-8"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">cv</span>(fpt1d)</span>
<span id="cb6-9"><a href="#cb6-9"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">min</span>(fpt1d)</span>
<span id="cb6-10"><a href="#cb6-10"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(fpt1d)</span>
<span id="cb6-11"><a href="#cb6-11"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt1d , <span class="dt">center=</span> <span class="ot">TRUE</span> , <span class="dt">order =</span> <span class="dv">4</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt1d , <span class="dt">center=</span> <span class="ot">FALSE</span> , <span class="dt">order =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>The kernel density approximation of ‘fpt1d’, using <code>dfptsde1d()</code> function (<code>hist=TRUE</code> based on <code>truehist()</code> function in <a href="https://cran.r-project.org/package=MASS">MASS</a> package)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(<span class="kw">dfptsde1d</span>(fpt1d),<span class="dt">hist=</span><span class="ot">TRUE</span>,<span class="dt">nbins=</span><span class="st">&quot;FD&quot;</span>)  <span class="co">## histogramm</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(<span class="kw">dfptsde1d</span>(fpt1d))              <span class="co">## kernel density</span></span></code></pre></div>
<p>Since <a href="https://cran.r-project.org/package=fptdApprox">fptdApprox</a> and <a href="https://cran.r-project.org/package=DiffusionRgqd">DiffusionRgqd</a> packages can very effectively handle first passage time problems for diffusions with analytically tractable transitional densities we use it to compare some of the results from the Sim.DiffProc package.</p>
<div id="fptsde1d-vs-approx.fpt.density" class="section level3">
<h3><code>fptsde1d()</code> vs <code>Approx.fpt.density()</code></h3>
<p>Consider for example a diffusion process with SDE:</p>
<p><span class="math display">\[\begin{align*}
  dX_{t}= &amp;  0.48 X_{t} dt + 0.07 X_{t} dW_{t},~x_{0} =1.\\
  S(t)= &amp; 7 + 3.2  t + 1.4  t  \sin(1.75  t)
\end{align*}\]</span> The resulting object is then used by the <code>Approx.fpt.density()</code> function in package <a href="https://cran.r-project.org/package=fptdApprox">fptdApprox</a> to approximate the first passage time density:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">require</span>(fptdApprox)</span>
<span id="cb8-2"><a href="#cb8-2"></a>R<span class="op">&gt;</span><span class="st"> </span>x &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="dv">4</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>R<span class="op">&gt;</span><span class="st"> </span>x[<span class="dv">1</span>] &lt;-<span class="st"> &quot;m * x&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>R<span class="op">&gt;</span><span class="st"> </span>x[<span class="dv">2</span>] &lt;-<span class="st"> &quot;(sigma^2) * x^2&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>R<span class="op">&gt;</span><span class="st"> </span>x[<span class="dv">3</span>] &lt;-<span class="st"> &quot;dnorm((log(x) - (log(y) + (m - sigma^2/2) * (t- s)))/(sigma * sqrt(t - s)),0,1)/(sigma * sqrt(t - s) * x)&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>R<span class="op">&gt;</span><span class="st"> </span>x[<span class="dv">4</span>] &lt;-<span class="st"> &quot;plnorm(x,log(y) + (m - sigma^2/2) * (t - s),sigma * sqrt(t - s))&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>R<span class="op">&gt;</span><span class="st"> </span>Lognormal &lt;-<span class="st"> </span><span class="kw">diffproc</span>(x)</span>
<span id="cb8-8"><a href="#cb8-8"></a>R<span class="op">&gt;</span><span class="st"> </span>res1 &lt;-<span class="st"> </span><span class="kw">Approx.fpt.density</span>(Lognormal, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="st">&quot;7 + 3.2 * t + 1.4 * t * sin(1.75 * t)&quot;</span>,<span class="kw">list</span>(<span class="dt">m =</span> <span class="fl">0.48</span>,<span class="dt">sigma =</span> <span class="fl">0.07</span>))</span></code></pre></div>
<p>Using <code>fptsde1d()</code> and <code>dfptsde1d()</code> functions in the <a href="https://cran.r-project.org/package=Sim.DiffProc">Sim.DiffProc</a> package:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="co">## Set the model X(t)</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>R<span class="op">&gt;</span><span class="st"> </span>f &lt;-<span class="st"> </span><span class="kw">expression</span>( <span class="fl">0.48</span><span class="op">*</span>x )</span>
<span id="cb9-3"><a href="#cb9-3"></a>R<span class="op">&gt;</span><span class="st"> </span>g &lt;-<span class="st"> </span><span class="kw">expression</span>( <span class="fl">0.07</span><span class="op">*</span>x )</span>
<span id="cb9-4"><a href="#cb9-4"></a>R<span class="op">&gt;</span><span class="st"> </span>mod1 &lt;-<span class="st"> </span><span class="kw">snssde1d</span>(<span class="dt">drift=</span>f,<span class="dt">diffusion=</span>g,<span class="dt">x0=</span><span class="dv">1</span>,<span class="dt">T=</span><span class="dv">10</span>,<span class="dt">M=</span><span class="dv">1000</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="co">## Set the boundary S(t)</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>R<span class="op">&gt;</span><span class="st"> </span>St  &lt;-<span class="st"> </span><span class="kw">expression</span>( <span class="dv">7</span> <span class="op">+</span><span class="st"> </span><span class="fl">3.2</span> <span class="op">*</span><span class="st"> </span>t <span class="op">+</span><span class="st"> </span><span class="fl">1.4</span> <span class="op">*</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(<span class="fl">1.75</span> <span class="op">*</span><span class="st"> </span>t) )</span>
<span id="cb9-7"><a href="#cb9-7"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="co">## Generate the fpt</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>R<span class="op">&gt;</span><span class="st"> </span>fpt1 &lt;-<span class="st"> </span><span class="kw">fptsde1d</span>(mod1, <span class="dt">boundary =</span> St)</span>
<span id="cb9-9"><a href="#cb9-9"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(fpt1<span class="op">$</span>fpt, <span class="dt">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>[1] 8.4491 5.8324 6.2194 6.0628 6.0337</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(fpt1)</span></code></pre></div>
<pre><code>
Monte-Carlo Statistics of F.P.T:
|T(S(t),X(t)) = inf{t &gt;=  0 : X(t) &gt;=  7 + 3.2 * t + 1.4 * t * sin(1.75 * t) }
                         
Mean              6.45436
Variance          0.82529
Median            6.09538
Mode              6.00222
First quartile    5.93615
Third quartile    6.33197
Minimum           5.47910
Maximum           8.92931
Skewness          1.62490
Kurtosis          3.97197
Coef-variation    0.14075
3th-order moment  1.21824
4th-order moment  2.70530
5th-order moment  5.36133
6th-order moment 11.11820</code></pre>
<p>By plotting the approximations:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(res1<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>res1<span class="op">$</span>x, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;Approximation First-Passage-Time Density&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Density&#39;</span>, <span class="dt">xlab =</span> <span class="kw">expression</span>(tau[<span class="kw">S</span>(t)]),<span class="dt">cex.main =</span> <span class="fl">0.95</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(<span class="kw">dfptsde1d</span>(fpt1,<span class="dt">bw=</span><span class="st">&quot;bcv&quot;</span>),<span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="st">&#39;#BBCCEE&#39;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="dv">15</span>),<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Approx.fpt.density()&#39;</span>, <span class="st">&#39;fptsde1d()&#39;</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption"><code>fptsde1d()</code> vs <code>Approx.fpt.density()</code></p>
</div>
</div>
<div id="fptsde1d-vs-gqd.tipassage" class="section level3">
<h3><code>fptsde1d()</code> vs <code>GQD.TIpassage()</code></h3>
<p>Consider for example a diffusion process with SDE:</p>
<p><span class="math display">\[\begin{align*}
  dX_{t}= &amp;  \theta_{1}X_{t}(10+0.2\sin(2\pi t)+0.3\sqrt(t)(1+\cos(3\pi t))-X_{t}) )  dt + \sqrt(0.1) X_{t} dW_{t},~x_{0} =8.\\
  S(t)= &amp; 12
\end{align*}\]</span> The resulting object is then used by the <code>GQD.TIpassage()</code> function in package <a href="https://cran.r-project.org/package=DiffusionRgqd">DiffusionRgqd</a> to approximate the first passage time density:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">require</span>(DiffusionRgqd)</span>
<span id="cb14-2"><a href="#cb14-2"></a>R<span class="op">&gt;</span><span class="st"> </span>G1 &lt;-<span class="st"> </span><span class="cf">function</span>(t)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="op">+</span><span class="st">      </span>{</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="op">+</span><span class="st">  </span>theta[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>(<span class="dv">10</span><span class="fl">+0.2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>t) <span class="op">+</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span><span class="kw">prod</span>(<span class="kw">sqrt</span>(t),</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="op">+</span><span class="st">  </span><span class="dv">1</span><span class="op">+</span><span class="kw">cos</span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>t)))</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="op">+</span><span class="st">  </span>}</span>
<span id="cb14-7"><a href="#cb14-7"></a>R<span class="op">&gt;</span><span class="st"> </span>G2 &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="op">-</span>theta[<span class="dv">1</span>]}</span>
<span id="cb14-8"><a href="#cb14-8"></a>R<span class="op">&gt;</span><span class="st"> </span>Q2 &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="fl">0.1</span>}</span>
<span id="cb14-9"><a href="#cb14-9"></a>R<span class="op">&gt;</span><span class="st"> </span>res2 =<span class="st"> </span><span class="kw">GQD.TIpassage</span>(<span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>, <span class="dt">theta =</span> <span class="kw">c</span>(<span class="fl">0.5</span>))</span></code></pre></div>
<p>Using <code>fptsde1d()</code> and <code>dfptsde1d()</code> functions in the <a href="https://cran.r-project.org/package=Sim.DiffProc">Sim.DiffProc</a> package:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="co">## Set the model X(t)</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>R<span class="op">&gt;</span><span class="st"> </span>theta1=<span class="fl">0.5</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>R<span class="op">&gt;</span><span class="st"> </span>f &lt;-<span class="st"> </span><span class="kw">expression</span>( theta1<span class="op">*</span>x<span class="op">*</span>(<span class="dv">10</span><span class="fl">+0.2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>t)<span class="op">+</span><span class="fl">0.3</span><span class="op">*</span><span class="kw">sqrt</span>(t)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">cos</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>t))<span class="op">-</span>x) )</span>
<span id="cb15-4"><a href="#cb15-4"></a>R<span class="op">&gt;</span><span class="st"> </span>g &lt;-<span class="st"> </span><span class="kw">expression</span>( <span class="kw">sqrt</span>(<span class="fl">0.1</span>)<span class="op">*</span>x )</span>
<span id="cb15-5"><a href="#cb15-5"></a>R<span class="op">&gt;</span><span class="st"> </span>mod2 &lt;-<span class="st"> </span><span class="kw">snssde1d</span>(<span class="dt">drift=</span>f,<span class="dt">diffusion=</span>g,<span class="dt">x0=</span><span class="dv">8</span>,<span class="dt">t0=</span><span class="dv">1</span>,<span class="dt">T=</span><span class="dv">4</span>,<span class="dt">M=</span><span class="dv">1000</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="co">## Set the boundary S(t)</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>R<span class="op">&gt;</span><span class="st"> </span>St  &lt;-<span class="st"> </span><span class="kw">expression</span>( <span class="dv">12</span> )</span>
<span id="cb15-8"><a href="#cb15-8"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="co">## Generate the fpt</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>R<span class="op">&gt;</span><span class="st"> </span>fpt2 &lt;-<span class="st"> </span><span class="kw">fptsde1d</span>(mod2, <span class="dt">boundary =</span> St)</span>
<span id="cb15-10"><a href="#cb15-10"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(fpt2<span class="op">$</span>fpt, <span class="dt">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>[1] 1.9278 1.3564 2.7549 1.8239 1.5315</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(fpt2)</span></code></pre></div>
<pre><code>
Monte-Carlo Statistics of F.P.T:
|T(S(t),X(t)) = inf{t &gt;=  1 : X(t) &gt;=  12 }
                        
Mean             2.20795
Variance         0.50426
Median           2.10384
Mode             1.45117
First quartile   1.55048
Third quartile   2.68149
Minimum          1.09881
Maximum          3.99568
Skewness         0.53741
Kurtosis         2.31695
Coef-variation   0.32162
3th-order moment 0.19243
4th-order moment 0.58915
5th-order moment 0.52001
6th-order moment 0.99788</code></pre>
<p>By plotting the approximations (<code>hist=TRUE</code> based on <code>truehist()</code> function in <a href="https://cran.r-project.org/package=MASS">MASS</a> package):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(<span class="kw">dfptsde1d</span>(fpt2),<span class="dt">hist=</span><span class="ot">TRUE</span>,<span class="dt">nbins =</span> <span class="st">&quot;Scott&quot;</span>,<span class="dt">main =</span> <span class="st">&#39;Approximation First-Passage-Time Density&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Density&#39;</span>, <span class="dt">xlab =</span> <span class="kw">expression</span>(tau[<span class="kw">S</span>(t)]), <span class="dt">cex.main =</span> <span class="fl">0.95</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">lines</span>(res2<span class="op">$</span>density <span class="op">~</span><span class="st"> </span>res2<span class="op">$</span>time, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="st">&#39;#FF00004B&#39;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="dv">15</span>),<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;GQD.TIpassage()&#39;</span>, <span class="st">&#39;fptsde1d()&#39;</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption"><code>fptsde1d()</code> vs <code>GQD.TIpassage()</code></p>
</div>
</div>
</div>
<div id="fpt-for-2-dim-sdes" class="section level2">
<h2>FPT for 2-Dim SDE’s</h2>
<p>Assume that we want to describe the following Stratonovich SDE’s (2D):</p>
<p><span class="math display">\[\begin{equation}\label{eq016}
\begin{cases}
dX_t = 5 (-1-Y_{t}) X_{t} dt + 0.5 Y_{t} \circ dW_{1,t}\\
dY_t = 5 (-1-X_{t}) Y_{t} dt + 0.5 X_{t} \circ dW_{2,t}
\end{cases}
\end{equation}\]</span></p>
<p>and <span class="math display">\[
S(t)=\sin(2\pi t)
\]</span></p>
<p>Set the system <span class="math inline">\((X_t , Y_t)\)</span>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>, <span class="dt">kind =</span> <span class="st">&quot;L&#39;Ecuyer-CMRG&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>R<span class="op">&gt;</span><span class="st"> </span>fx &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="dv">5</span><span class="op">*</span>(<span class="op">-</span><span class="dv">1</span><span class="op">-</span>y)<span class="op">*</span>x , <span class="dv">5</span><span class="op">*</span>(<span class="op">-</span><span class="dv">1</span><span class="op">-</span>x)<span class="op">*</span>y)</span>
<span id="cb20-3"><a href="#cb20-3"></a>R<span class="op">&gt;</span><span class="st"> </span>gx &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="fl">0.5</span><span class="op">*</span>y,<span class="fl">0.5</span><span class="op">*</span>x)</span>
<span id="cb20-4"><a href="#cb20-4"></a>R<span class="op">&gt;</span><span class="st"> </span>mod2d &lt;-<span class="st"> </span><span class="kw">snssde2d</span>(<span class="dt">drift=</span>fx,<span class="dt">diffusion=</span>gx,<span class="dt">x0=</span><span class="kw">c</span>(<span class="dt">x=</span><span class="dv">1</span>,<span class="dt">y=</span><span class="op">-</span><span class="dv">1</span>),<span class="dt">M=</span><span class="dv">1000</span>,<span class="dt">type=</span><span class="st">&quot;str&quot;</span>)</span></code></pre></div>
<p>Generate the couple <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})})\)</span>, with <code>fptsde2d()</code> function::</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>R<span class="op">&gt;</span><span class="st"> </span>St &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>t))</span>
<span id="cb21-2"><a href="#cb21-2"></a>R<span class="op">&gt;</span><span class="st"> </span>fpt2d &lt;-<span class="st"> </span><span class="kw">fptsde2d</span>(mod2d, <span class="dt">boundary =</span> St)</span>
<span id="cb21-3"><a href="#cb21-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(fpt2d<span class="op">$</span>fpt, <span class="dt">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>        x       y
1 0.13622 0.50310
2 0.14040 0.50428
3 0.13260 0.50229
4 0.14323 0.50805
5 0.13881 0.51709</code></pre>
<p>The following statistical measures (<code>S3 method</code>) for class <code>fptsde2d()</code> can be approximated for the couple <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})})\)</span>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(fpt2d)</span>
<span id="cb23-2"><a href="#cb23-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt2d , <span class="dt">center =</span> <span class="ot">TRUE</span> , <span class="dt">order =</span> <span class="dv">2</span>) <span class="co">## variance</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">Median</span>(fpt2d)</span>
<span id="cb23-4"><a href="#cb23-4"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">Mode</span>(fpt2d)</span>
<span id="cb23-5"><a href="#cb23-5"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(fpt2d)</span>
<span id="cb23-6"><a href="#cb23-6"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">kurtosis</span>(fpt2d)</span>
<span id="cb23-7"><a href="#cb23-7"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">skewness</span>(fpt2d)</span>
<span id="cb23-8"><a href="#cb23-8"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">cv</span>(fpt2d)</span>
<span id="cb23-9"><a href="#cb23-9"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">min</span>(fpt2d)</span>
<span id="cb23-10"><a href="#cb23-10"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(fpt2d)</span>
<span id="cb23-11"><a href="#cb23-11"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt2d , <span class="dt">center=</span> <span class="ot">TRUE</span> , <span class="dt">order =</span> <span class="dv">4</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt2d , <span class="dt">center=</span> <span class="ot">FALSE</span> , <span class="dt">order =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>The result summaries of the couple <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})})\)</span>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(fpt2d)</span></code></pre></div>
<pre><code>
Monte-Carlo Statistics for the F.P.T of (X(t),Y(t))
    | T(S(t),X(t)) = inf{t &gt;=  0 : X(t) &lt;=  sin(2 * pi * t) }
    |    And
    | T(S(t),Y(t)) = inf{t &gt;=  0 : Y(t) &gt;=  sin(2 * pi * t) }
                  T(S,X)   T(S,Y)
Mean             0.13470  0.50335
Variance         0.00019  0.00003
Median           0.13418  0.50319
Mode             0.13300  0.50272
First quartile   0.12511  0.49986
Third quartile   0.14343  0.50675
Minimum          0.09431  0.48489
Maximum          0.22080  0.52167
Skewness         0.38774 -0.00054
Kurtosis         4.33349  3.16471
Coef-variation   0.10167  0.01046
3th-order moment 0.00000  0.00000
4th-order moment 0.00000  0.00000
5th-order moment 0.00000  0.00000
6th-order moment 0.00000  0.00000</code></pre>
<p>The marginal density of <span class="math inline">\((\tau_{(S(t),X_{t})}\)</span> and <span class="math inline">\(\tau_{(S(t),Y_{t})})\)</span> are reported using <code>dfptsde2d()</code> function.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>R<span class="op">&gt;</span><span class="st"> </span>denM &lt;-<span class="st"> </span><span class="kw">dfptsde2d</span>(fpt2d, <span class="dt">pdf =</span> <span class="st">&#39;M&#39;</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(denM)</span></code></pre></div>
<p>A <code>contour</code> and <code>image</code> plot of density obtained from a realization of system <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})})\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>R<span class="op">&gt;</span><span class="st"> </span>denJ &lt;-<span class="st"> </span><span class="kw">dfptsde2d</span>(fpt2d, <span class="dt">pdf =</span> <span class="st">&#39;J&#39;</span>,<span class="dt">n=</span><span class="dv">100</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(denJ,<span class="dt">display=</span><span class="st">&quot;contour&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Bivariate Density of F.P.T&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(tau[x]),<span class="dt">ylab=</span><span class="kw">expression</span>(tau[y]))</span>
<span id="cb27-3"><a href="#cb27-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(denJ,<span class="dt">display=</span><span class="st">&quot;image&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Bivariate Density of F.P.T&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(tau[x]),<span class="dt">ylab=</span><span class="kw">expression</span>(tau[y]))</span></code></pre></div>
<p>A <span class="math inline">\(3\)</span>D plot of the Joint density with:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(denJ,<span class="dt">display=</span><span class="st">&quot;persp&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Bivariate Density of F.P.T&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(tau[x]),<span class="dt">ylab=</span><span class="kw">expression</span>(tau[y]))</span></code></pre></div>
<p><a href="#FPT%20for%202-Dim%20SDE">Return to fptsde2d()</a></p>
</div>
<div id="fpt-for-3-dim-sdes" class="section level2">
<h2>FPT for 3-Dim SDE’s</h2>
<p>Assume that we want to describe the following SDE’s (3D): <span class="math display">\[\begin{equation}\label{eq0166}
\begin{cases}
dX_t = 4 (-1-X_{t}) Y_{t} dt + 0.2 dB_{1,t}\\
dY_t = 4 (1-Y_{t}) X_{t} dt + 0.2 dB_{2,t}\\
dZ_t = 4 (1-Z_{t}) Y_{t} dt + 0.2 dB_{3,t}
\end{cases}
\end{equation}\]</span> with <span class="math inline">\((B_{1,t},B_{2,t},B_{3,t})\)</span> are three correlated standard Wiener process: <span class="math display">\[
\Sigma=
\begin{pmatrix}
1 &amp; 0.3 &amp;-0.5\\
0.3 &amp; 1 &amp; 0.2 \\
-0.5 &amp;0.2&amp;1
\end{pmatrix}
\]</span> and <span class="math display">\[
S(t)=-1.5+3t
\]</span></p>
<p>Set the system <span class="math inline">\((X_t , Y_t , Z_t)\)</span>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">1234</span>, <span class="dt">kind =</span> <span class="st">&quot;L&#39;Ecuyer-CMRG&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>R<span class="op">&gt;</span><span class="st"> </span>fx &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="dv">4</span><span class="op">*</span>(<span class="op">-</span><span class="dv">1</span><span class="op">-</span>x)<span class="op">*</span>y , <span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y)<span class="op">*</span>x , <span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>z)<span class="op">*</span>y) </span>
<span id="cb29-3"><a href="#cb29-3"></a>R<span class="op">&gt;</span><span class="st"> </span>gx &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">expression</span>(<span class="fl">0.2</span>),<span class="dv">3</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a>R<span class="op">&gt;</span><span class="st"> </span>Sigma &lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a>R<span class="op">&gt;</span><span class="st"> </span>mod3d &lt;-<span class="st"> </span><span class="kw">snssde3d</span>(<span class="dt">drift=</span>fx,<span class="dt">diffusion=</span>gx,<span class="dt">x0=</span><span class="kw">c</span>(<span class="dt">x=</span><span class="dv">2</span>,<span class="dt">y=</span><span class="op">-</span><span class="dv">2</span>,<span class="dt">z=</span><span class="dv">0</span>),<span class="dt">M=</span><span class="dv">1000</span>,<span class="dt">corr=</span>Sigma)</span></code></pre></div>
<p>Generate the triplet <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})},\tau_{(S(t),Z_{t})})\)</span>, with <code>fptsde3d()</code> function::</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>R<span class="op">&gt;</span><span class="st"> </span>St &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>t)</span>
<span id="cb30-2"><a href="#cb30-2"></a>R<span class="op">&gt;</span><span class="st"> </span>fpt3d &lt;-<span class="st"> </span><span class="kw">fptsde3d</span>(mod3d, <span class="dt">boundary =</span> St)</span>
<span id="cb30-3"><a href="#cb30-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(fpt3d<span class="op">$</span>fpt, <span class="dt">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>        x        y       z
1 0.51850 0.024239 0.75841
2 0.52495 0.024041 0.80606
3 0.53565 0.021115 0.75086
4 0.53324 0.023411 0.74892
5 0.54566 0.023167 0.76537</code></pre>
<p>The following statistical measures (<code>S3 method</code>) for class <code>fptsde3d()</code> can be approximated for the triplet <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})},\tau_{(S(t),Z_{t})})\)</span>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(fpt3d)</span>
<span id="cb32-2"><a href="#cb32-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt3d , <span class="dt">center =</span> <span class="ot">TRUE</span> , <span class="dt">order =</span> <span class="dv">2</span>) <span class="co">## variance</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">Median</span>(fpt3d)</span>
<span id="cb32-4"><a href="#cb32-4"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">Mode</span>(fpt3d)</span>
<span id="cb32-5"><a href="#cb32-5"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(fpt3d)</span>
<span id="cb32-6"><a href="#cb32-6"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">kurtosis</span>(fpt3d)</span>
<span id="cb32-7"><a href="#cb32-7"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">skewness</span>(fpt3d)</span>
<span id="cb32-8"><a href="#cb32-8"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">cv</span>(fpt3d)</span>
<span id="cb32-9"><a href="#cb32-9"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">min</span>(fpt3d)</span>
<span id="cb32-10"><a href="#cb32-10"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(fpt3d)</span>
<span id="cb32-11"><a href="#cb32-11"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt3d , <span class="dt">center=</span> <span class="ot">TRUE</span> , <span class="dt">order =</span> <span class="dv">4</span>)</span>
<span id="cb32-12"><a href="#cb32-12"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">moment</span>(fpt3d , <span class="dt">center=</span> <span class="ot">FALSE</span> , <span class="dt">order =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>The result summaries of the triplet <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})},\tau_{(S(t),Z_{t})})\)</span>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">summary</span>(fpt3d)</span></code></pre></div>
<pre><code>
Monte-Carlo Statistics for the F.P.T of (X(t),Y(t),Z(t))
    | T(S(t),X(t)) = inf{t &gt;=  0 : X(t) &lt;=  -1.5 + 3 * t }
    |    And
    | T(S(t),Y(t)) = inf{t &gt;=  0 : Y(t) &gt;=  -1.5 + 3 * t }
    |    And
    | T(S(t),Z(t)) = inf{t &gt;=  0 : Z(t) &lt;=  -1.5 + 3 * t }
                  T(S,X)  T(S,Y)   T(S,Z)
Mean             0.53198 0.02323  0.78404
Variance         0.00015 0.00000  0.00093
Median           0.53138 0.02321  0.78402
Mode             0.53097 0.02353  0.78322
First quartile   0.52328 0.02231  0.76216
Third quartile   0.53975 0.02407  0.80498
Minimum          0.49196 0.01912  0.68248
Maximum          0.56943 0.02792  0.88831
Skewness         0.17921 0.16558 -0.01077
Kurtosis         2.96629 2.99563  2.99648
Coef-variation   0.02298 0.05735  0.03897
3th-order moment 0.00000 0.00000  0.00000
4th-order moment 0.00000 0.00000  0.00000
5th-order moment 0.00000 0.00000  0.00000
6th-order moment 0.00000 0.00000  0.00000</code></pre>
<p>The marginal density of <span class="math inline">\(\tau_{(S(t),X_{t})}\)</span> ,<span class="math inline">\(\tau_{(S(t),Y_{t})}\)</span> and <span class="math inline">\(\tau_{(S(t),Z_{t})})\)</span> are reported using <code>dfptsde3d()</code> function.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>R<span class="op">&gt;</span><span class="st"> </span>denM &lt;-<span class="st"> </span><span class="kw">dfptsde3d</span>(fpt3d, <span class="dt">pdf =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(denM)</span></code></pre></div>
<p>For an approximate joint density for <span class="math inline">\((\tau_{(S(t),X_{t})},\tau_{(S(t),Y_{t})},\tau_{(S(t),Z_{t})})\)</span> (for more details, see package <a href="https://cran.r-project.org/package=sm">sm</a> or <a href="https://cran.r-project.org/package=ks">ks</a>.)</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>R<span class="op">&gt;</span><span class="st"> </span>denJ &lt;-<span class="st"> </span><span class="kw">dfptsde3d</span>(fpt3d,<span class="dt">pdf=</span><span class="st">&quot;J&quot;</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>R<span class="op">&gt;</span><span class="st"> </span><span class="kw">plot</span>(denJ,<span class="dt">display=</span><span class="st">&quot;rgl&quot;</span>)</span></code></pre></div>
<p><a href="#fptsde3d">Return to fptsde3d()</a></p>
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further reading</h1>
<ol style="list-style-type: decimal">
<li><a href="snssde.html"><code>snssdekd()</code> &amp; <code>dsdekd()</code> &amp; <code>rsdekd()</code>- Monte-Carlo Simulation and Analysis of Stochastic Differential Equations</a>.</li>
<li><a href="bridgesde.html"><code>bridgesdekd()</code> &amp; <code>dsdekd()</code> &amp; <code>rsdekd()</code> - Constructs and Analysis of Bridges Stochastic Differential Equations</a>.</li>
<li><a href="fptsde.html"><code>fptsdekd()</code> &amp; <code>dfptsdekd()</code> - Monte-Carlo Simulation and Kernel Density Estimation of First passage time</a>.</li>
<li><a href="mcmsde.html"><code>MCM.sde()</code> &amp; <code>MEM.sde()</code> - Parallel Monte-Carlo and Moment Equations for SDEs</a>.</li>
<li><a href="sdetotex.html"><code>TEX.sde()</code> - Converting Sim.DiffProc Objects to LaTeX</a>.</li>
<li><a href="fitsde.html"><code>fitsde()</code> - Parametric Estimation of 1-D Stochastic Differential Equation</a>.</li>
</ol>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ol style="list-style-type: decimal">
<li><p>Boukhetala K (1996). Modelling and Simulation of a Dispersion Pollutant with Attractive Centre, volume 3, pp. 245-252. Computer Methods and Water Resources, Computational Mechanics Publications, Boston, USA.</p></li>
<li><p>Boukhetala K (1998). Estimation of the first passage time distribution for a simulated diffusion process. Maghreb Mathematical Review, 7, pp. 1-25.</p></li>
<li><p>Boukhetala K (1998). Kernel density of the exit time in a simulated diffusion. The Annals of The Engineer Maghrebian, 12, pp. 587-589.</p></li>
<li><p>Guidoum AC, Boukhetala K (2020). Sim.DiffProc: Simulation of Diffusion Processes. R package version 4.8, URL <a href="https://cran.r-project.org/package=Sim.DiffProc" class="uri">https://cran.r-project.org/package=Sim.DiffProc</a>.</p></li>
<li><p>Pienaar EAD, Varughese MM (2016). DiffusionRgqd: An R Package for Performing Inference and Analysis on Time-Inhomogeneous Quadratic Diffusion Processes. R package version 0.1.3, URL <a href="https://CRAN.R-project.org/package=DiffusionRgqd" class="uri">https://CRAN.R-project.org/package=DiffusionRgqd</a>.</p></li>
<li><p>Roman, R.P., Serrano, J. J., Torres, F. (2008). First-passage-time location function: Application to determine first-passage-time densities in diffusion processes. Computational Statistics and Data Analysis. 52, 4132-4146.</p></li>
<li><p>Roman, R.P., Serrano, J. J., Torres, F. (2012). An R package for an efficient approximation of first-passage-time densities for diffusion processes based on the FPTL function. Applied Mathematics and Computation, 218, 8408-8428.</p></li>
</ol>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Department of Probabilities &amp; Statistics, Faculty of Mathematics, University of Science and Technology Houari Boumediene, BP 32 El-Alia, U.S.T.H.B, Algeria, E-mail (<a href="mailto:acguidoum@usthb.dz" class="email">acguidoum@usthb.dz</a>)<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Faculty of Mathematics, University of Science and Technology Houari Boumediene, BP 32 El-Alia, U.S.T.H.B, Algeria, E-mail (<a href="mailto:kboukhetala@usthb.dz" class="email">kboukhetala@usthb.dz</a>)<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<script type="text/javascript">
window.onload = function() {
  var i, fig = 1, caps = document.getElementsByClassName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.className !== 'figure' || cap.nodeName !== 'P')
      continue;
    cap.innerHTML = '<span>Figure ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
  fig = 1;
  caps = document.getElementsByTagName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.nodeName !== 'TABLE') continue;
    cap.innerHTML = '<span>Table ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
}
</script>


<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
